

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>PARCIAL FINAL &#8212; Parcial de Machine Learning</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'parcial';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to your Jupyter Book" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">PARCIAL FINAL</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fparcial.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/parcial.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PARCIAL FINAL</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PARCIAL FINAL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-fraudes">DETECCIÓN DE FRAUDES</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-la-base-de-datos">Análisis exploratorio de la base de datos:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-variables-independientes">selección de variables independientes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-faltantes">Datos faltantes:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histogramas-y-diagramas-de-barras">Histogramas y diagramas de barras:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-bivariado">Análisis bivariado:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-dimensionalidad">Reducción de dimensionalidad:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-a-datos-faltantes">Imputación a datos faltantes:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vif">VIF:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-de-la-velocidad-del-viento">PREDICCIÓN DE LA VELOCIDAD DEL VIENTO:</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-los-datos">Analisis exploratorio de los datos:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma-y-diagrama-de-barras">Histograma y Diagrama de barras:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Análisis Bivariado:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-dimensionalidad-vif">Reducción de dimensionalidad: VIF</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#velocidad-del-viento-modelos">VELOCIDAD DEL VIENTO: MODELOS</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-y-validacion">Entrenamiento y validación</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nn-regresion">K-NN (Regresión):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-ridge">Regresión Ridge:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lasso">Regresión Lasso:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp-regresion">MLP ( Regresión)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboosting">XGBoosting:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-entre-mejores-modelos">Comparación entre mejores modelos:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculo-del-r-2">Cálculo del <span class="math notranslate nohighlight">\(R^2\)</span>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados">Resultados:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">CONCLUSIONES:</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="parcial-final">
<h1>PARCIAL FINAL<a class="headerlink" href="#parcial-final" title="Permalink to this heading">#</a></h1>
<p>Presentado por: Angie Vanesa Guerrero Bertel</p>
<p>Profesor: Lihki Rubio</p>
<p>Fecha: 08/10/2023</p>
<ul class="simple">
<li><p>LIBRERÍAS</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">kurtosis</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">ShuffleSplit</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GroupKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.dummy</span> <span class="kn">import</span> <span class="n">DummyClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">f1_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_recall_curve</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">average_precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_curve</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">roc_auc_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1">#Importe la librería ScikitLearn específicamente el algoritmo de LOF</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_log_error</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">explained_variance_score</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.neural_network</span> <span class="kn">import</span> <span class="n">MLPRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span>
<span class="kn">import</span> <span class="nn">xgboost</span> <span class="k">as</span> <span class="nn">xgb</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Importamos la base de datos sobre detención de fraude</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">archivo_csv</span> <span class="o">=</span> <span class="s2">&quot;train_transaction.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">archivo_csv</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All data shape: &#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All data shape:  (590540, 394)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>...</th>
      <th>V330</th>
      <th>V331</th>
      <th>V332</th>
      <th>V333</th>
      <th>V334</th>
      <th>V335</th>
      <th>V336</th>
      <th>V337</th>
      <th>V338</th>
      <th>V339</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>0</td>
      <td>86400</td>
      <td>68.5</td>
      <td>W</td>
      <td>13926</td>
      <td>NaN</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>0</td>
      <td>86401</td>
      <td>29.0</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>0</td>
      <td>86469</td>
      <td>59.0</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>0</td>
      <td>86499</td>
      <td>50.0</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>0</td>
      <td>86506</td>
      <td>50.0</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 394 columns</p>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="deteccion-de-fraudes">
<h1>DETECCIÓN DE FRAUDES<a class="headerlink" href="#deteccion-de-fraudes" title="Permalink to this heading">#</a></h1>
<section id="analisis-exploratorio-de-la-base-de-datos">
<h2>Análisis exploratorio de la base de datos:<a class="headerlink" href="#analisis-exploratorio-de-la-base-de-datos" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 394 entries, TransactionID to V339
dtypes: float64(376), int64(4), object(14)
memory usage: 1.7+ GB
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Número de observaciones en la base de datos:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Número de observaciones: &#39;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de observaciones:  590540
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Se tienen 394 atributos, de los cuales 380 son numéricos y 14 son categóricos.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>isFraud</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>...</th>
      <th>V330</th>
      <th>V331</th>
      <th>V332</th>
      <th>V333</th>
      <th>V334</th>
      <th>V335</th>
      <th>V336</th>
      <th>V337</th>
      <th>V338</th>
      <th>V339</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5.905400e+05</td>
      <td>590540.000000</td>
      <td>5.905400e+05</td>
      <td>590540.000000</td>
      <td>590540.000000</td>
      <td>581607.000000</td>
      <td>588975.000000</td>
      <td>586281.000000</td>
      <td>524834.000000</td>
      <td>524834.000000</td>
      <td>...</td>
      <td>82351.000000</td>
      <td>82351.000000</td>
      <td>82351.000000</td>
      <td>82351.000000</td>
      <td>82351.000000</td>
      <td>82351.00000</td>
      <td>82351.000000</td>
      <td>82351.000000</td>
      <td>82351.000000</td>
      <td>82351.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>3.282270e+06</td>
      <td>0.034990</td>
      <td>7.372311e+06</td>
      <td>135.027176</td>
      <td>9898.734658</td>
      <td>362.555488</td>
      <td>153.194925</td>
      <td>199.278897</td>
      <td>290.733794</td>
      <td>86.800630</td>
      <td>...</td>
      <td>0.775874</td>
      <td>721.741883</td>
      <td>1375.783644</td>
      <td>1014.622782</td>
      <td>9.807015</td>
      <td>59.16455</td>
      <td>28.530903</td>
      <td>55.352422</td>
      <td>151.160542</td>
      <td>100.700882</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.704744e+05</td>
      <td>0.183755</td>
      <td>4.617224e+06</td>
      <td>239.162522</td>
      <td>4901.170153</td>
      <td>157.793246</td>
      <td>11.336444</td>
      <td>41.244453</td>
      <td>101.741072</td>
      <td>2.690623</td>
      <td>...</td>
      <td>4.727971</td>
      <td>6217.223583</td>
      <td>11169.275702</td>
      <td>7955.735482</td>
      <td>243.861391</td>
      <td>387.62948</td>
      <td>274.576920</td>
      <td>668.486833</td>
      <td>1095.034387</td>
      <td>814.946722</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.987000e+06</td>
      <td>0.000000</td>
      <td>8.640000e+04</td>
      <td>0.251000</td>
      <td>1000.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>100.000000</td>
      <td>10.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>3.134635e+06</td>
      <td>0.000000</td>
      <td>3.027058e+06</td>
      <td>43.321000</td>
      <td>6019.000000</td>
      <td>214.000000</td>
      <td>150.000000</td>
      <td>166.000000</td>
      <td>204.000000</td>
      <td>87.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>3.282270e+06</td>
      <td>0.000000</td>
      <td>7.306528e+06</td>
      <td>68.769000</td>
      <td>9678.000000</td>
      <td>361.000000</td>
      <td>150.000000</td>
      <td>226.000000</td>
      <td>299.000000</td>
      <td>87.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.429904e+06</td>
      <td>0.000000</td>
      <td>1.124662e+07</td>
      <td>125.000000</td>
      <td>14184.000000</td>
      <td>512.000000</td>
      <td>150.000000</td>
      <td>226.000000</td>
      <td>330.000000</td>
      <td>87.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>25.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.577539e+06</td>
      <td>1.000000</td>
      <td>1.581113e+07</td>
      <td>31937.391000</td>
      <td>18396.000000</td>
      <td>600.000000</td>
      <td>231.000000</td>
      <td>237.000000</td>
      <td>540.000000</td>
      <td>102.000000</td>
      <td>...</td>
      <td>55.000000</td>
      <td>160000.000000</td>
      <td>160000.000000</td>
      <td>160000.000000</td>
      <td>55125.000000</td>
      <td>55125.00000</td>
      <td>55125.000000</td>
      <td>104060.000000</td>
      <td>104060.000000</td>
      <td>104060.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 380 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_NA</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">data_NA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionID          0
isFraud                0
TransactionDT          0
TransactionAmt         0
ProductCD              0
                   ...  
V335              508189
V336              508189
V337              508189
V338              508189
V339              508189
Length: 394, dtype: int64
</pre></div>
</div>
</div>
</div>
<section id="seleccion-de-variables-independientes">
<h3>selección de variables independientes<a class="headerlink" href="#seleccion-de-variables-independientes" title="Permalink to this heading">#</a></h3>
<p>Se eligieron mínimo cuatro variables independientes</p>
<ul class="simple">
<li><p>Variable respuesta: isFraud—&gt; categórica</p></li>
<li><p>Variables independientes: TransactionAmt, ProductCD, card1, card4</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nuevo_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">,</span> <span class="s1">&#39;ProductCD&#39;</span><span class="p">,</span> <span class="s1">&#39;card1&#39;</span><span class="p">,</span> <span class="s1">&#39;card4&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nuevo_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Data columns (total 5 columns):
 #   Column          Non-Null Count   Dtype  
---  ------          --------------   -----  
 0   isFraud         590540 non-null  int64  
 1   TransactionAmt  590540 non-null  float64
 2   ProductCD       590540 non-null  object 
 3   card1           590540 non-null  int64  
 4   card4           588963 non-null  object 
dtypes: float64(1), int64(2), object(2)
memory usage: 22.5+ MB
</pre></div>
</div>
</div>
</div>
<p>seleccionando como variables independientes “TransactionAmt” , “ProductCD “, “card1”, “card4”, tenemos una data de 590540 observaciones, la única variable independiente con valores faltantes es ‘card4’, la cual es categórica y tiene solo 588963 registros.</p>
<ul class="simple">
<li><p>Estadística descriptiva: Media, desviasión estándar, mínimo, máximo, cuartiles</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nuevo_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>isFraud</th>
      <td>590540.0</td>
      <td>0.034990</td>
      <td>0.183755</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>1.000</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>590540.0</td>
      <td>135.027176</td>
      <td>239.162522</td>
      <td>0.251</td>
      <td>43.321</td>
      <td>68.769</td>
      <td>125.0</td>
      <td>31937.391</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>590540.0</td>
      <td>9898.734658</td>
      <td>4901.170153</td>
      <td>1000.000</td>
      <td>6019.000</td>
      <td>9678.000</td>
      <td>14184.0</td>
      <td>18396.000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Podemos ver que las variables transactionAmt, TransactionDT y card1 tienen diferentes escalas de medida.</p>
<p>TransactionAmt –&gt; tiene una media de 135,027 con una desviación estándar de 239.16.Vemos que el 50% de los datos tienen un registro igual o inferior a 68.769.</p>
<p>card1–&gt; tiene una media de 9898,73 con una desviación estándar de 4901,17. vemos que el valor mínimo es de 1000 y máximo de 18396. Un 50% de los datos tienen un registro en card1 por debajo de la media.</p>
</section>
<section id="datos-faltantes">
<h3>Datos faltantes:<a class="headerlink" href="#datos-faltantes" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Conteo de datos faltantes:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_data_NA</span> <span class="o">=</span> <span class="n">nuevo_df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">all_data_NA</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;All NA&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>All NA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>isFraud</th>
      <td>0</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>0</td>
    </tr>
    <tr>
      <th>ProductCD</th>
      <td>0</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>card4</th>
      <td>1577</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Vemos que la columna “card4” tiene 1577 datos faltantes.</p>
<ul class="simple">
<li><p>Porcentaje de datos faltantes:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">porcentaje_faltantes_por_columna</span> <span class="o">=</span> <span class="p">((</span><span class="n">all_data_NA</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">nuevo_df</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">porcentaje_faltantes_por_columna</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>isFraud           0.000000
TransactionAmt    0.000000
ProductCD         0.000000
card1             0.000000
card4             0.267044
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>vemos que el 0,267 % de los datos tienen registros faltantes en la variable “card4”</p>
</section>
<section id="histogramas-y-diagramas-de-barras">
<h3>Histogramas y diagramas de barras:<a class="headerlink" href="#histogramas-y-diagramas-de-barras" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Variable respuesta: isFraud</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Detección de fraude: conteo&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">nuevo_df</span><span class="o">.</span><span class="n">isFraud</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Fraude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ba86b7201ac2d45001b1aff3e9af5a0c41acd5e12419b794bc85eac013f5f55c.png" src="_images/ba86b7201ac2d45001b1aff3e9af5a0c41acd5e12419b794bc85eac013f5f55c.png" />
</div>
</div>
<p>Vemos que la muestra está bastante desbalanceada; teniendo pocos registros de fraude.</p>
<ul class="simple">
<li><p>variables independientes categóricas: ‘card4’ y ‘ProductCD’</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Tipo de tarjeta&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">nuevo_df</span><span class="o">.</span><span class="n">card4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Tarjeta&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/43e58190999cb8cf4b36de8c3ae3202e16643b76db69c7a6d796606aba6338e3.png" src="_images/43e58190999cb8cf4b36de8c3ae3202e16643b76db69c7a6d796606aba6338e3.png" />
</div>
</div>
<p>El Diagrama de barras nos muestra que de los registros, la mayoría tiene tarjeta de crédito visa, seguida de mastercard. la tarjeta tipo discover es de la que se tiene menos registros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;ticks&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ProductCD: Conteo&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">nuevo_df</span><span class="o">.</span><span class="n">ProductCD</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ProductCD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1f2edcc6a5f7d697fa610ef3e03aba2d48dd8347d87004f6f93bbb9dca7131bf.png" src="_images/1f2edcc6a5f7d697fa610ef3e03aba2d48dd8347d87004f6f93bbb9dca7131bf.png" />
</div>
</div>
<p>con respecto a la variable ‘ProductCD’ , el mayor registro es ‘W’, seguido de ‘C’ y ‘R’. Con menos registros está ‘S’</p>
<ul class="simple">
<li><p>Histogramas:</p></li>
</ul>
<p>Variables numéricas: ‘TransactionAmt’ y ‘card1’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nuevo_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isFraud</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>68.5</td>
      <td>W</td>
      <td>13926</td>
      <td>discover</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>29.0</td>
      <td>W</td>
      <td>2755</td>
      <td>mastercard</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>59.0</td>
      <td>W</td>
      <td>4663</td>
      <td>visa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>50.0</td>
      <td>W</td>
      <td>18132</td>
      <td>mastercard</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>50.0</td>
      <td>H</td>
      <td>4497</td>
      <td>mastercard</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.8</span><span class="p">)</span>
<span class="n">nuevo_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span> <span class="p">,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;Blue&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2bb47e122ebfe58f8587749345893aca1b7782c2fbac9c2cd577f9922a9bac31.png" src="_images/2bb47e122ebfe58f8587749345893aca1b7782c2fbac9c2cd577f9922a9bac31.png" />
</div>
</div>
<p>Vemos que las variables TransactionAmt y card1 no siguen una distribución normal.</p>
<ul class="simple">
<li><p>Análisis de simetría, datos atípicos y dispersión:</p></li>
</ul>
<ul class="simple">
<li><p>Variables numéricas:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_cols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">,</span> <span class="s1">&#39;card1&#39;</span><span class="p">]</span>
<span class="n">custom_palette</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s2">&quot;Set2&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">num_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column: &#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skew:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">nuevo_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kurtosis: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">nuevo_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">nuevo_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">custom_palette</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="c1">#sin fondo cuadriculado y primer color de los colores personalizados</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">nuevo_df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;Set2&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  TransactionAmt
Skew: 14.37
Kurtosis:  1123.96
</pre></div>
</div>
<img alt="_images/8fbec5cc3c34000153129feb96ec0073f19a9d8e4a059581044ea5f0b95b4480.png" src="_images/8fbec5cc3c34000153129feb96ec0073f19a9d8e4a059581044ea5f0b95b4480.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  card1
Skew: -0.04
Kurtosis:  -1.14
</pre></div>
</div>
<img alt="_images/4a9e52f0c7d51a7c010a707be8a4210e2103511782b01c1d8f98c849f7a2123b.png" src="_images/4a9e52f0c7d51a7c010a707be8a4210e2103511782b01c1d8f98c849f7a2123b.png" />
</div>
</div>
<p>vemos que la variable card1 tiene un leve sesgo negativo (Mayor peso en la cola derecha de la distribución ), mientras que la variable ‘TransactionAmt’, tiene un sesgo positivo (Mayor peso en la cola izquierda de la distribución), hay una fuerte asimetría y evidentemente no hay normalidad en esta variable: también se visualizan posibles datos atípicos en el boxplot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">melted_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">nuevo_df</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s2">&quot;isFraud&quot;</span><span class="p">,</span><span class="n">value_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">,</span> <span class="s1">&#39;card1&#39;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;isFraud&quot;</span><span class="p">,</span><span class="n">data</span><span class="o">=</span> <span class="n">melted_data</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fbb4981324440630cffb0dd8ee1f1a2348f985b90f611a7bbe2a019c7165f057.png" src="_images/fbb4981324440630cffb0dd8ee1f1a2348f985b90f611a7bbe2a019c7165f057.png" />
</div>
</div>
</section>
<section id="analisis-bivariado">
<h3>Análisis bivariado:<a class="headerlink" href="#analisis-bivariado" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Variables independientes: TransactionAmt card1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">nuevo_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;card1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatterplot: card1 vs TransactionAmt&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">nuevo_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;card1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Regplot: card1 vs TransactionAmt&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e781c9436b384c87c34da1804cd5b4a72a01cd4b0f01f31617ad95365d767c1a.png" src="_images/e781c9436b384c87c34da1804cd5b4a72a01cd4b0f01f31617ad95365d767c1a.png" />
</div>
</div>
<p>El gráfico nos muestra que no hay visualmente una asociación lineal entre las variables transactionAmt y card1</p>
<ul class="simple">
<li><p>Variables independientes: ‘TransactionDT’,’TransactionAmt’</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;TransactionDT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatterplot: TransactionDT vs TransactionAmt&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;TransactionAmt&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;TransactionDT&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Regplot: TransactionDT vs TransactionAmt&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7428a2c4905b9894c3388b82d7b6c8a8cf9243e8653a5d8aca53545a0faeabf3.png" src="_images/7428a2c4905b9894c3388b82d7b6c8a8cf9243e8653a5d8aca53545a0faeabf3.png" />
</div>
</div>
<p>Para las variables TransactionDT y TransactionAmt , no se ve una asociación lineal entre las dos variables. vemos que muchos datos se concentran en la izquierda, por lo que no es claro si a medida que aumentan transactionAmt aumentan transactionDT</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;card5&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;card3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatterplot: card5 vs card3&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;card5&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;card3&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Regplot: card5 vs card3&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a90b74f0871fb2fd94541a1b0caed71ccd097da30f75c0230cb8faad5fe3f06.png" src="_images/8a90b74f0871fb2fd94541a1b0caed71ccd097da30f75c0230cb8faad5fe3f06.png" />
</div>
</div>
<p>Para las variables card5 y card3 se ve mucha dispersión de los datos. no es clara la tendencia, probablemente a medida que aumentan card5 , card3 disminuye.</p>
<ul class="simple">
<li><p>variables explicativas: card2 y addr1:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;card2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;addr1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Scatterplot: card2 vs addr1&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;card2&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;addr1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Regplot: card2 vs addr1&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9cab8edefd7bfab8221fb7935b27cf2396893055c0d6be8d96eb51a94c8fc881.png" src="_images/9cab8edefd7bfab8221fb7935b27cf2396893055c0d6be8d96eb51a94c8fc881.png" />
</div>
</div>
<p>Los gráficos anteriores no muestran con claridad si hay alguna relación lineal entre las variables. la línea de tendencia nos muestra que a medida que aumenta card2 , addr1 también</p>
</section>
</section>
<section id="reduccion-de-dimensionalidad">
<h2>Reducción de dimensionalidad:<a class="headerlink" href="#reduccion-de-dimensionalidad" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 394 entries, TransactionID to V339
dtypes: float64(376), int64(4), object(14)
memory usage: 1.7+ GB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">verificacion_NA</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">verificacion_NA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionID          0
isFraud                0
TransactionDT          0
TransactionAmt         0
ProductCD              0
                   ...  
V335              508189
V336              508189
V337              508189
V338              508189
V339              508189
Length: 394, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">porcentaje_faltante_col</span> <span class="o">=</span> <span class="p">((</span><span class="n">verificacion_NA</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">porcentaje_faltante_col</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionID      0.000000
isFraud            0.000000
TransactionDT      0.000000
TransactionAmt     0.000000
ProductCD          0.000000
                    ...    
V335              86.054967
V336              86.054967
V337              86.054967
V338              86.054967
V339              86.054967
Length: 394, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Dado que hay muchas columnas del dataset con datos faltantes que representan una cantidad considerable, he definido un umbral inicial de 15%. Aquellas columnas que tengan el 15% de la muestra sin registros serán eliminadas, esto debido a que son demasiados datos faltantes y una imputación de la mediana para tantos datos no sería apropiado</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#eliminar las columnas con un porcentaje de valores faltantes mayor al 20%.</span>
<span class="n">umbral</span> <span class="o">=</span> <span class="mi">15</span>
<span class="c1"># columnas que cumplen con el criterio de porcentaje faltante mayor al umbral.</span>
<span class="n">columnas_a_eliminar</span> <span class="o">=</span> <span class="n">porcentaje_faltante_col</span><span class="p">[</span><span class="n">porcentaje_faltante_col</span> <span class="o">&gt;</span> <span class="n">umbral</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">columnas_a_eliminar</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>234
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Eliminar las columnas del DataFrame original.</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columnas_a_eliminar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>eliminando las columnas con más de 15% de datos faltantes, nos quedan un total de 160 atributos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 160 entries, TransactionID to V321
dtypes: float64(153), int64(4), object(3)
memory usage: 720.9+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ver_NA</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">ver_NA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionID      0
isFraud            0
TransactionDT      0
TransactionAmt     0
ProductCD          0
                  ..
V317              12
V318              12
V319              12
V320              12
V321              12
Length: 160, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">faltante_col</span> <span class="o">=</span> <span class="p">((</span><span class="n">ver_NA</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">faltante_col</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionID     0.000000
isFraud           0.000000
TransactionDT     0.000000
TransactionAmt    0.000000
ProductCD         0.000000
                    ...   
V317              0.002032
V318              0.002032
V319              0.002032
V320              0.002032
V321              0.002032
Length: 160, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Podemos ver que el nuevo dataset con 160 atributos cuenta con una proporción baja de datos faltantes. Se procede a continuar con el tratamiento de los datos faltantes.</p>
<section id="imputacion-a-datos-faltantes">
<h3>Imputación a datos faltantes:<a class="headerlink" href="#imputacion-a-datos-faltantes" title="Permalink to this heading">#</a></h3>
<p>Para los datos numéricos se imputará con la mediana aquellos datos faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TransactionID</th>
      <td>590540.0</td>
      <td>3.282270e+06</td>
      <td>1.704744e+05</td>
      <td>2987000.000</td>
      <td>3134634.750</td>
      <td>3282269.500</td>
      <td>3429904.25</td>
      <td>3.577539e+06</td>
    </tr>
    <tr>
      <th>isFraud</th>
      <td>590540.0</td>
      <td>3.499001e-02</td>
      <td>1.837546e-01</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>TransactionDT</th>
      <td>590540.0</td>
      <td>7.372311e+06</td>
      <td>4.617224e+06</td>
      <td>86400.000</td>
      <td>3027057.750</td>
      <td>7306527.500</td>
      <td>11246620.00</td>
      <td>1.581113e+07</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>590540.0</td>
      <td>1.350272e+02</td>
      <td>2.391625e+02</td>
      <td>0.251</td>
      <td>43.321</td>
      <td>68.769</td>
      <td>125.00</td>
      <td>3.193739e+04</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>590540.0</td>
      <td>9.898735e+03</td>
      <td>4.901170e+03</td>
      <td>1000.000</td>
      <td>6019.000</td>
      <td>9678.000</td>
      <td>14184.00</td>
      <td>1.839600e+04</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>V317</th>
      <td>590528.0</td>
      <td>2.476067e+02</td>
      <td>3.980043e+03</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.340210e+05</td>
    </tr>
    <tr>
      <th>V318</th>
      <td>590528.0</td>
      <td>1.621534e+02</td>
      <td>2.793344e+03</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>9.847600e+04</td>
    </tr>
    <tr>
      <th>V319</th>
      <td>590528.0</td>
      <td>1.837248e+01</td>
      <td>3.323048e+02</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.040600e+05</td>
    </tr>
    <tr>
      <th>V320</th>
      <td>590528.0</td>
      <td>4.207313e+01</td>
      <td>4.734993e+02</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.040600e+05</td>
    </tr>
    <tr>
      <th>V321</th>
      <td>590528.0</td>
      <td>2.832658e+01</td>
      <td>3.820532e+02</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.040600e+05</td>
    </tr>
  </tbody>
</table>
<p>157 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C_categorica</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">C_numerica</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables categóricas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C_categorica</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables numéricas:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">C_numerica</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables categóricas:
Index([&#39;ProductCD&#39;, &#39;card4&#39;, &#39;card6&#39;], dtype=&#39;object&#39;)
Variables numéricas:
[&#39;TransactionID&#39;, &#39;isFraud&#39;, &#39;TransactionDT&#39;, &#39;TransactionAmt&#39;, &#39;card1&#39;, &#39;card2&#39;, &#39;card3&#39;, &#39;card5&#39;, &#39;addr1&#39;, &#39;addr2&#39;, &#39;C1&#39;, &#39;C2&#39;, &#39;C3&#39;, &#39;C4&#39;, &#39;C5&#39;, &#39;C6&#39;, &#39;C7&#39;, &#39;C8&#39;, &#39;C9&#39;, &#39;C10&#39;, &#39;C11&#39;, &#39;C12&#39;, &#39;C13&#39;, &#39;C14&#39;, &#39;D1&#39;, &#39;D10&#39;, &#39;V12&#39;, &#39;V13&#39;, &#39;V14&#39;, &#39;V15&#39;, &#39;V16&#39;, &#39;V17&#39;, &#39;V18&#39;, &#39;V19&#39;, &#39;V20&#39;, &#39;V21&#39;, &#39;V22&#39;, &#39;V23&#39;, &#39;V24&#39;, &#39;V25&#39;, &#39;V26&#39;, &#39;V27&#39;, &#39;V28&#39;, &#39;V29&#39;, &#39;V30&#39;, &#39;V31&#39;, &#39;V32&#39;, &#39;V33&#39;, &#39;V34&#39;, &#39;V53&#39;, &#39;V54&#39;, &#39;V55&#39;, &#39;V56&#39;, &#39;V57&#39;, &#39;V58&#39;, &#39;V59&#39;, &#39;V60&#39;, &#39;V61&#39;, &#39;V62&#39;, &#39;V63&#39;, &#39;V64&#39;, &#39;V65&#39;, &#39;V66&#39;, &#39;V67&#39;, &#39;V68&#39;, &#39;V69&#39;, &#39;V70&#39;, &#39;V71&#39;, &#39;V72&#39;, &#39;V73&#39;, &#39;V74&#39;, &#39;V95&#39;, &#39;V96&#39;, &#39;V97&#39;, &#39;V98&#39;, &#39;V99&#39;, &#39;V100&#39;, &#39;V101&#39;, &#39;V102&#39;, &#39;V103&#39;, &#39;V104&#39;, &#39;V105&#39;, &#39;V106&#39;, &#39;V107&#39;, &#39;V108&#39;, &#39;V109&#39;, &#39;V110&#39;, &#39;V111&#39;, &#39;V112&#39;, &#39;V113&#39;, &#39;V114&#39;, &#39;V115&#39;, &#39;V116&#39;, &#39;V117&#39;, &#39;V118&#39;, &#39;V119&#39;, &#39;V120&#39;, &#39;V121&#39;, &#39;V122&#39;, &#39;V123&#39;, &#39;V124&#39;, &#39;V125&#39;, &#39;V126&#39;, &#39;V127&#39;, &#39;V128&#39;, &#39;V129&#39;, &#39;V130&#39;, &#39;V131&#39;, &#39;V132&#39;, &#39;V133&#39;, &#39;V134&#39;, &#39;V135&#39;, &#39;V136&#39;, &#39;V137&#39;, &#39;V279&#39;, &#39;V280&#39;, &#39;V281&#39;, &#39;V282&#39;, &#39;V283&#39;, &#39;V284&#39;, &#39;V285&#39;, &#39;V286&#39;, &#39;V287&#39;, &#39;V288&#39;, &#39;V289&#39;, &#39;V290&#39;, &#39;V291&#39;, &#39;V292&#39;, &#39;V293&#39;, &#39;V294&#39;, &#39;V295&#39;, &#39;V296&#39;, &#39;V297&#39;, &#39;V298&#39;, &#39;V299&#39;, &#39;V300&#39;, &#39;V301&#39;, &#39;V302&#39;, &#39;V303&#39;, &#39;V304&#39;, &#39;V305&#39;, &#39;V306&#39;, &#39;V307&#39;, &#39;V308&#39;, &#39;V309&#39;, &#39;V310&#39;, &#39;V311&#39;, &#39;V312&#39;, &#39;V313&#39;, &#39;V314&#39;, &#39;V315&#39;, &#39;V316&#39;, &#39;V317&#39;, &#39;V318&#39;, &#39;V319&#39;, &#39;V320&#39;, &#39;V321&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">C_numerica</span><span class="p">:</span>
    <span class="n">m_norm_loss</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">m_norm_loss</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">veri_NA</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">veri_NA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TransactionID     0
isFraud           0
TransactionDT     0
TransactionAmt    0
ProductCD         0
                 ..
V317              0
V318              0
V319              0
V320              0
V321              0
Length: 160, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>TransactionID</th>
      <td>590540.0</td>
      <td>3.282270e+06</td>
      <td>1.704744e+05</td>
      <td>2987000.000</td>
      <td>3134634.750</td>
      <td>3282269.500</td>
      <td>3429904.25</td>
      <td>3.577539e+06</td>
    </tr>
    <tr>
      <th>isFraud</th>
      <td>590540.0</td>
      <td>3.499001e-02</td>
      <td>1.837546e-01</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>TransactionDT</th>
      <td>590540.0</td>
      <td>7.372311e+06</td>
      <td>4.617224e+06</td>
      <td>86400.000</td>
      <td>3027057.750</td>
      <td>7306527.500</td>
      <td>11246620.00</td>
      <td>1.581113e+07</td>
    </tr>
    <tr>
      <th>TransactionAmt</th>
      <td>590540.0</td>
      <td>1.350272e+02</td>
      <td>2.391625e+02</td>
      <td>0.251</td>
      <td>43.321</td>
      <td>68.769</td>
      <td>125.00</td>
      <td>3.193739e+04</td>
    </tr>
    <tr>
      <th>card1</th>
      <td>590540.0</td>
      <td>9.898735e+03</td>
      <td>4.901170e+03</td>
      <td>1000.000</td>
      <td>6019.000</td>
      <td>9678.000</td>
      <td>14184.00</td>
      <td>1.839600e+04</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>V317</th>
      <td>590540.0</td>
      <td>2.476017e+02</td>
      <td>3.980003e+03</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.340210e+05</td>
    </tr>
    <tr>
      <th>V318</th>
      <td>590540.0</td>
      <td>1.621501e+02</td>
      <td>2.793315e+03</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>9.847600e+04</td>
    </tr>
    <tr>
      <th>V319</th>
      <td>590540.0</td>
      <td>1.837210e+01</td>
      <td>3.323015e+02</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.040600e+05</td>
    </tr>
    <tr>
      <th>V320</th>
      <td>590540.0</td>
      <td>4.207228e+01</td>
      <td>4.734945e+02</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.040600e+05</td>
    </tr>
    <tr>
      <th>V321</th>
      <td>590540.0</td>
      <td>2.832601e+01</td>
      <td>3.820493e+02</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>1.040600e+05</td>
    </tr>
  </tbody>
</table>
<p>157 rows × 8 columns</p>
</div></div></div>
</div>
<p>Ahora, verifiquemos datos faltantes en las variables categóricas:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">C_categorica</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;ProductCD&#39;, &#39;card4&#39;, &#39;card6&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">C_categorica</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
1577
1571
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">C_categorica</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(((</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
0.267043722694483
0.26602770345785215
</pre></div>
</div>
</div>
</div>
<p>Vemos que dos variables categóricas tienen aproximadamente un 0.26% de datos faltantes; calcularemos la frecuencia de las categorías en dichas variables:</p>
<ul class="simple">
<li><p>card4:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;card4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>card4
visa                384767
mastercard          189217
american express      8328
discover              6651
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Reemplazamos los valores faltantes de la variable ‘card4’ por el valor que más se repite:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;card4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;visa&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>card6:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;card6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>card6
debit              439938
credit             148986
debit or credit        30
charge card            15
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Reemplazamos los valores faltantes de la variable ‘card6’ por el valor que más se repite:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;card6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s2">&quot;debit&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Verifiquemos ahora los datos faltantes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">C_categorica</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
0
0
</pre></div>
</div>
</div>
</div>
<p>Dataset resultante no tiene filas con datos faltantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">filas_con_datos_faltantes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">filas_con_datos_faltantes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0         False
1         False
2         False
3         False
4         False
          ...  
590535    False
590536    False
590537    False
590538    False
590539    False
Length: 590540, dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="ow">not</span> <span class="n">filas_con_datos_faltantes</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Todas las filas tienen datos completos &quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Al menos una fila tiene datos faltantes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Todas las filas tienen datos completos 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 590540 entries, 0 to 590539
Columns: 160 entries, TransactionID to V321
dtypes: float64(153), int64(4), object(3)
memory usage: 720.9+ MB
</pre></div>
</div>
</div>
</div>
<p>Tenemos finalmente un dataset de 590540 registros y 160 atributos. Procedemos a utilizar la técnica Variance Inflation Factor, para realizar
reducción de dimensionalidad por medio de eliminiación de columnas altamente correlacionadas</p>
</section>
<section id="vif">
<h3>VIF:<a class="headerlink" href="#vif" title="Permalink to this heading">#</a></h3>
<p>Primeramente, excluimos la variable dependiente y realizamos OneHotEncoder para las variables categoricas (‘ProductCD’, ‘card4’, ‘card6’)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;isFraud&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_new</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>ProductCD</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card4</th>
      <th>card5</th>
      <th>card6</th>
      <th>...</th>
      <th>V312</th>
      <th>V313</th>
      <th>V314</th>
      <th>V315</th>
      <th>V316</th>
      <th>V317</th>
      <th>V318</th>
      <th>V319</th>
      <th>V320</th>
      <th>V321</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>86400</td>
      <td>68.5</td>
      <td>W</td>
      <td>13926</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>discover</td>
      <td>142.0</td>
      <td>credit</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>117.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>86401</td>
      <td>29.0</td>
      <td>W</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>credit</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>86469</td>
      <td>59.0</td>
      <td>W</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>visa</td>
      <td>166.0</td>
      <td>debit</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>86499</td>
      <td>50.0</td>
      <td>W</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>117.0</td>
      <td>debit</td>
      <td>...</td>
      <td>135.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>50.0</td>
      <td>1404.0</td>
      <td>790.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>86506</td>
      <td>50.0</td>
      <td>H</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>mastercard</td>
      <td>102.0</td>
      <td>credit</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 159 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;ProductCD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;W&#39;, &#39;H&#39;, &#39;C&#39;, &#39;S&#39;, &#39;R&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;card4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;discover&#39;, &#39;mastercard&#39;, &#39;visa&#39;, &#39;american express&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;card6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;credit&#39;, &#39;debit&#39;, &#39;debit or credit&#39;, &#39;charge card&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>OneHotEncoder para variables categóricas:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;ProductCD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">enc</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">X1</span><span class="o">=</span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;card4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">enc1</span><span class="o">=</span><span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span>
<span class="n">X1</span> <span class="o">=</span> <span class="n">enc1</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X1</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="n">X2</span><span class="o">=</span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;card6&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">enc2</span><span class="o">=</span><span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
<span class="n">X2</span><span class="o">=</span><span class="n">enc2</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 1.],
       [0., 0., 0., 1.],
       [0., 0., 0., 1.],
       ...,
       [0., 0., 0., 1.],
       [0., 0., 0., 1.],
       [0., 0., 0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.],
       ...,
       [0., 1., 0.],
       [0., 1., 0.],
       [0., 1., 0.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0., 0.],
       [1., 0., 0.],
       [0., 1., 0.],
       ...,
       [0., 1., 0.],
       [0., 1., 0.],
       [1., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>A continuación creamos un dataframe a partir de las variables previamente procesadas por OneHotEncoder, se eliminó una etiqueta por variable para evitar multicolinealidad.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">([</span><span class="s1">&#39;ProductCD&#39;</span><span class="p">]))</span>
<span class="n">X1_encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="n">enc1</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">([</span><span class="s1">&#39;card4&#39;</span><span class="p">]))</span>
<span class="n">X2_encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span> <span class="n">enc2</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">([</span><span class="s1">&#39;card6&#39;</span><span class="p">]))</span>
<span class="n">encoded_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">X_encoded_df</span><span class="p">,</span><span class="n">X1_encoded_df</span><span class="p">,</span><span class="n">X2_encoded_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">encoded_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ProductCD_H</th>
      <th>ProductCD_R</th>
      <th>ProductCD_S</th>
      <th>ProductCD_W</th>
      <th>card4_discover</th>
      <th>card4_mastercard</th>
      <th>card4_visa</th>
      <th>card6_credit</th>
      <th>card6_debit</th>
      <th>card6_debit or credit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Concatenamos este dataframe con el original(con solo las variables numéricas):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new_num</span><span class="o">=</span><span class="n">df_new</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;ProductCD&#39;</span><span class="p">,</span><span class="s1">&#39;card4&#39;</span><span class="p">,</span> <span class="s1">&#39;card6&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_new_num</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>C1</th>
      <th>...</th>
      <th>V312</th>
      <th>V313</th>
      <th>V314</th>
      <th>V315</th>
      <th>V316</th>
      <th>V317</th>
      <th>V318</th>
      <th>V319</th>
      <th>V320</th>
      <th>V321</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>86400</td>
      <td>68.5</td>
      <td>13926</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>117.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>86401</td>
      <td>29.0</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>86469</td>
      <td>59.0</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>86499</td>
      <td>50.0</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>135.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>50.0</td>
      <td>1404.0</td>
      <td>790.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>86506</td>
      <td>50.0</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 156 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_01</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_new_num</span><span class="p">,</span> <span class="n">encoded_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_01</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>TransactionID</th>
      <th>TransactionDT</th>
      <th>TransactionAmt</th>
      <th>card1</th>
      <th>card2</th>
      <th>card3</th>
      <th>card5</th>
      <th>addr1</th>
      <th>addr2</th>
      <th>C1</th>
      <th>...</th>
      <th>ProductCD_H</th>
      <th>ProductCD_R</th>
      <th>ProductCD_S</th>
      <th>ProductCD_W</th>
      <th>card4_discover</th>
      <th>card4_mastercard</th>
      <th>card4_visa</th>
      <th>card6_credit</th>
      <th>card6_debit</th>
      <th>card6_debit or credit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2987000</td>
      <td>86400</td>
      <td>68.50</td>
      <td>13926</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>142.0</td>
      <td>315.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2987001</td>
      <td>86401</td>
      <td>29.00</td>
      <td>2755</td>
      <td>404.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2987002</td>
      <td>86469</td>
      <td>59.00</td>
      <td>4663</td>
      <td>490.0</td>
      <td>150.0</td>
      <td>166.0</td>
      <td>330.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2987003</td>
      <td>86499</td>
      <td>50.00</td>
      <td>18132</td>
      <td>567.0</td>
      <td>150.0</td>
      <td>117.0</td>
      <td>476.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2987004</td>
      <td>86506</td>
      <td>50.00</td>
      <td>4497</td>
      <td>514.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>420.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>590535</th>
      <td>3577535</td>
      <td>15811047</td>
      <td>49.00</td>
      <td>6550</td>
      <td>361.0</td>
      <td>150.0</td>
      <td>226.0</td>
      <td>272.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>590536</th>
      <td>3577536</td>
      <td>15811049</td>
      <td>39.50</td>
      <td>10444</td>
      <td>225.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>204.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>590537</th>
      <td>3577537</td>
      <td>15811079</td>
      <td>30.95</td>
      <td>12037</td>
      <td>595.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>231.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>590538</th>
      <td>3577538</td>
      <td>15811088</td>
      <td>117.00</td>
      <td>7826</td>
      <td>481.0</td>
      <td>150.0</td>
      <td>224.0</td>
      <td>387.0</td>
      <td>87.0</td>
      <td>1.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>590539</th>
      <td>3577539</td>
      <td>15811131</td>
      <td>279.95</td>
      <td>15066</td>
      <td>170.0</td>
      <td>150.0</td>
      <td>102.0</td>
      <td>299.0</td>
      <td>87.0</td>
      <td>2.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>590540 rows × 166 columns</p>
</div></div></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="prediccion-de-la-velocidad-del-viento">
<h1>PREDICCIÓN DE LA VELOCIDAD DEL VIENTO:<a class="headerlink" href="#prediccion-de-la-velocidad-del-viento" title="Permalink to this heading">#</a></h1>
<section id="analisis-exploratorio-de-los-datos">
<h2>Analisis exploratorio de los datos:<a class="headerlink" href="#analisis-exploratorio-de-los-datos" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">archivo_csv2</span> <span class="o">=</span> <span class="s2">&quot;data_treino_dv_df_2000_2010.csv&quot;</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">archivo_csv2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All data shape: &#39;</span><span class="p">,</span> <span class="n">df2</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All data shape:  (87693, 13)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>HORA (UTC)</th>
      <th>VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))</th>
      <th>VENTO, VELOCIDADE HORARIA (m/s)</th>
      <th>UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)</th>
      <th>UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)</th>
      <th>TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)</th>
      <th>UMIDADE RELATIVA DO AR, HORARIA (%)</th>
      <th>PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)</th>
      <th>PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)</th>
      <th>VENTO, RAJADA MAXIMA (m/s)</th>
      <th>PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)</th>
      <th>PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>1.8</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>2.7</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>2.0</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>2.5</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>2.4</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>La base de datos de velocidad del viento corresponde a 87693 registros y 13 atributos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 87693 entries, 0 to 87692
Data columns (total 13 columns):
 #   Column                                                 Non-Null Count  Dtype  
---  ------                                                 --------------  -----  
 0   HORA (UTC)                                             87693 non-null  object 
 1   VENTO, DIREï¿½ï¿½O HORARIA (gr) (ï¿½ (gr))             87693 non-null  float64
 2   VENTO, VELOCIDADE HORARIA (m/s)                        87693 non-null  float64
 3   UMIDADE REL. MAX. NA HORA ANT. (AUT) (%)               87693 non-null  float64
 4   UMIDADE REL. MIN. NA HORA ANT. (AUT) (%)               87693 non-null  float64
 5   TEMPERATURA Mï¿½XIMA NA HORA ANT. (AUT) (ï¿½C)         87693 non-null  float64
 6   TEMPERATURA Mï¿½NIMA NA HORA ANT. (AUT) (ï¿½C)         87693 non-null  float64
 7   UMIDADE RELATIVA DO AR, HORARIA (%)                    87693 non-null  float64
 8   PRESSAO ATMOSFERICA AO NIVEL DA ESTACAO, HORARIA (mB)  87693 non-null  float64
 9   PRECIPITAï¿½ï¿½O TOTAL, HORï¿½RIO (mm)                 87693 non-null  float64
 10  VENTO, RAJADA MAXIMA (m/s)                             87693 non-null  float64
 11  PRESSï¿½O ATMOSFERICA MAX.NA HORA ANT. (AUT) (mB)      87693 non-null  float64
 12  PRESSï¿½O ATMOSFERICA MIN. NA HORA ANT. (AUT) (mB)     87693 non-null  float64
dtypes: float64(12), object(1)
memory usage: 8.7+ MB
</pre></div>
</div>
</div>
</div>
<p>Vemos que no hay datos faltantes , se tiene como variable categórica ‘hora’, y 12 variables numéricas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nuevos_nombres</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hora&#39;</span><span class="p">,</span> <span class="s1">&#39;viento_direc&#39;</span><span class="p">,</span> <span class="s1">&#39;velocidad&#39;</span><span class="p">,</span> <span class="s1">&#39;AUT_max&#39;</span><span class="p">,</span> <span class="s1">&#39;AUT_min&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMP_MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;REL_DO&#39;</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">,</span> <span class="s1">&#39;prec_total&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;Viento_rajmax&#39;</span><span class="p">,</span> <span class="s1">&#39;presion_max&#39;</span><span class="p">,</span> <span class="s1">&#39;presion_min&#39;</span><span class="p">]</span>
<span class="n">df2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">nuevos_nombres</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 87693 entries, 0 to 87692
Data columns (total 13 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   hora           87693 non-null  object 
 1   viento_direc   87693 non-null  float64
 2   velocidad      87693 non-null  float64
 3   AUT_max        87693 non-null  float64
 4   AUT_min        87693 non-null  float64
 5   TEMP_MAX       87693 non-null  float64
 6   TEMP_MIN       87693 non-null  float64
 7   REL_DO         87693 non-null  float64
 8   atm            87693 non-null  float64
 9   prec_total     87693 non-null  float64
 10  Viento_rajmax  87693 non-null  float64
 11  presion_max    87693 non-null  float64
 12  presion_min    87693 non-null  float64
dtypes: float64(12), object(1)
memory usage: 8.7+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>viento_direc</th>
      <td>87693.0</td>
      <td>0.405810</td>
      <td>0.686247</td>
      <td>-1.0</td>
      <td>-0.156434</td>
      <td>0.788011</td>
      <td>0.970296</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>velocidad</th>
      <td>87693.0</td>
      <td>2.466192</td>
      <td>1.313968</td>
      <td>0.0</td>
      <td>1.500000</td>
      <td>2.400000</td>
      <td>3.400000</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>AUT_max</th>
      <td>87693.0</td>
      <td>69.058465</td>
      <td>19.640222</td>
      <td>12.0</td>
      <td>54.000000</td>
      <td>72.000000</td>
      <td>87.000000</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>AUT_min</th>
      <td>87693.0</td>
      <td>63.176194</td>
      <td>20.166336</td>
      <td>10.0</td>
      <td>48.000000</td>
      <td>64.000000</td>
      <td>80.000000</td>
      <td>98.0</td>
    </tr>
    <tr>
      <th>TEMP_MAX</th>
      <td>87693.0</td>
      <td>21.921264</td>
      <td>3.721386</td>
      <td>9.2</td>
      <td>19.200000</td>
      <td>21.400000</td>
      <td>24.700000</td>
      <td>35.3</td>
    </tr>
    <tr>
      <th>TEMP_MIN</th>
      <td>87693.0</td>
      <td>20.684570</td>
      <td>3.513744</td>
      <td>8.4</td>
      <td>18.400000</td>
      <td>20.200000</td>
      <td>23.100000</td>
      <td>34.4</td>
    </tr>
    <tr>
      <th>REL_DO</th>
      <td>87693.0</td>
      <td>66.146682</td>
      <td>19.992327</td>
      <td>10.0</td>
      <td>51.000000</td>
      <td>68.000000</td>
      <td>84.000000</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>atm</th>
      <td>87693.0</td>
      <td>887.251925</td>
      <td>4.012404</td>
      <td>863.4</td>
      <td>885.300000</td>
      <td>887.200000</td>
      <td>889.100000</td>
      <td>1023.5</td>
    </tr>
    <tr>
      <th>prec_total</th>
      <td>87693.0</td>
      <td>0.160907</td>
      <td>1.307515</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>70.8</td>
    </tr>
    <tr>
      <th>Viento_rajmax</th>
      <td>87693.0</td>
      <td>5.161076</td>
      <td>2.311157</td>
      <td>0.0</td>
      <td>3.400000</td>
      <td>5.000000</td>
      <td>6.800000</td>
      <td>24.3</td>
    </tr>
    <tr>
      <th>presion_max</th>
      <td>87693.0</td>
      <td>887.580724</td>
      <td>3.646750</td>
      <td>865.3</td>
      <td>885.600000</td>
      <td>887.500000</td>
      <td>889.300000</td>
      <td>913.1</td>
    </tr>
    <tr>
      <th>presion_min</th>
      <td>87693.0</td>
      <td>886.891093</td>
      <td>3.564539</td>
      <td>862.8</td>
      <td>885.000000</td>
      <td>886.900000</td>
      <td>888.800000</td>
      <td>910.9</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ul class="simple">
<li><p>Estadística descriptiva: Media, desviasión estándar, mínimo, máximo, cuartiles</p></li>
</ul>
<p>Del análisis anterior, tenemos que:</p>
<p>La velocidad del viento (m/s) tiene registros mínimos de 0 y máximo de 10, con una velocidad promedio de 2.47m/s. el 75% de los registros son velocidades de viento interiores a 3.4 m/s.</p>
<p>La temperatura máxima y mínima registrada tienen valores promedios similares, siendo la máxima de 21,9 grados y la mínima de 20.68 grados.</p>
<p>los registros de rpesión atmosférica promedio fueron de 887 atmósferas con una desviación de 4.01 atm, con un registro máximo de 1023,5 atm.</p>
<p>Vemos que muchos atributos están en diferentes escalas de medida.</p>
<ul class="simple">
<li><p>Conteo de datos faltantes:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_NA</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">all_NA</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span> <span class="s1">&#39;All NA&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>All NA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>hora</th>
      <td>0</td>
    </tr>
    <tr>
      <th>viento_direc</th>
      <td>0</td>
    </tr>
    <tr>
      <th>velocidad</th>
      <td>0</td>
    </tr>
    <tr>
      <th>AUT_max</th>
      <td>0</td>
    </tr>
    <tr>
      <th>AUT_min</th>
      <td>0</td>
    </tr>
    <tr>
      <th>TEMP_MAX</th>
      <td>0</td>
    </tr>
    <tr>
      <th>TEMP_MIN</th>
      <td>0</td>
    </tr>
    <tr>
      <th>REL_DO</th>
      <td>0</td>
    </tr>
    <tr>
      <th>atm</th>
      <td>0</td>
    </tr>
    <tr>
      <th>prec_total</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Viento_rajmax</th>
      <td>0</td>
    </tr>
    <tr>
      <th>presion_max</th>
      <td>0</td>
    </tr>
    <tr>
      <th>presion_min</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En la base de datos no se registran datos faltantes.</p>
<section id="histograma-y-diagrama-de-barras">
<h3>Histograma y Diagrama de barras:<a class="headerlink" href="#histograma-y-diagrama-de-barras" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cate_cols</span><span class="o">=</span><span class="n">df2</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">nume_cols</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Categorical Variables:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cate_cols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Numerical Variables:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nume_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Categorical Variables:
Index([&#39;hora&#39;], dtype=&#39;object&#39;)
Numerical Variables:
[&#39;viento_direc&#39;, &#39;velocidad&#39;, &#39;AUT_max&#39;, &#39;AUT_min&#39;, &#39;TEMP_MAX&#39;, &#39;TEMP_MIN&#39;, &#39;REL_DO&#39;, &#39;atm&#39;, &#39;prec_total&#39;, &#39;Viento_rajmax&#39;, &#39;presion_max&#39;, &#39;presion_min&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">nume_cols</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Column: &#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Skew:&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">skew</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Kurtosis: &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">df2</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">grid</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df2</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  viento_direc
Skew: -0.86
Kurtosis:  -0.82
</pre></div>
</div>
<img alt="_images/aceb85bc340fcb4f35381de17585bf965a75590c8b64ff4617e8fa3bf342a083.png" src="_images/aceb85bc340fcb4f35381de17585bf965a75590c8b64ff4617e8fa3bf342a083.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  velocidad
Skew: 0.37
Kurtosis:  -0.11
</pre></div>
</div>
<img alt="_images/97c74134bafc7479611961d4900121cc60d2740c7036957e03b79e7fd6379541.png" src="_images/97c74134bafc7479611961d4900121cc60d2740c7036957e03b79e7fd6379541.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  AUT_max
Skew: -0.48
Kurtosis:  -0.78
</pre></div>
</div>
<img alt="_images/f2ce77bedba0863aa97882d517f7e47418a8a07ea9ad110b64b655458615eba3.png" src="_images/f2ce77bedba0863aa97882d517f7e47418a8a07ea9ad110b64b655458615eba3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  AUT_min
Skew: -0.23
Kurtosis:  -0.96
</pre></div>
</div>
<img alt="_images/d626cbfa89e5ad5695343acfc6c4323829e5881a0110d4e5bd1ded52ff68d234.png" src="_images/d626cbfa89e5ad5695343acfc6c4323829e5881a0110d4e5bd1ded52ff68d234.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  TEMP_MAX
Skew: 0.26
Kurtosis:  -0.42
</pre></div>
</div>
<img alt="_images/b43de008cf1d413061367bee302c2d9e90fa19bed362adfdba0a81d199bd8a7f.png" src="_images/b43de008cf1d413061367bee302c2d9e90fa19bed362adfdba0a81d199bd8a7f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  TEMP_MIN
Skew: 0.24
Kurtosis:  -0.12
</pre></div>
</div>
<img alt="_images/d8dbb65f1f544c63ea2646ecbb18cb29889cfbde7451845b8aeb8b4d06ceae9e.png" src="_images/d8dbb65f1f544c63ea2646ecbb18cb29889cfbde7451845b8aeb8b4d06ceae9e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  REL_DO
Skew: -0.35
Kurtosis:  -0.89
</pre></div>
</div>
<img alt="_images/de94aaf94d366ca8a92d46a99d77a7f850b86b7895f3dc7590ec8e1b320d343f.png" src="_images/de94aaf94d366ca8a92d46a99d77a7f850b86b7895f3dc7590ec8e1b320d343f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  atm
Skew: 6.18
Kurtosis:  179.64
</pre></div>
</div>
<img alt="_images/28736ef70554cc864933a36ab29d4228653a34ab0e2004a565b39028e0d15dbd.png" src="_images/28736ef70554cc864933a36ab29d4228653a34ab0e2004a565b39028e0d15dbd.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  prec_total
Skew: 17.65
Kurtosis:  476.4
</pre></div>
</div>
<img alt="_images/6cc1eadb837ee3b45cee84afccd964649892204a3852542716f52c5273ae8178.png" src="_images/6cc1eadb837ee3b45cee84afccd964649892204a3852542716f52c5273ae8178.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  Viento_rajmax
Skew: 0.41
Kurtosis:  0.11
</pre></div>
</div>
<img alt="_images/7d37417a0e5c6c2c3786b623fa65acecbc564e4e3a9fd4ef8b495ad3d76190c0.png" src="_images/7d37417a0e5c6c2c3786b623fa65acecbc564e4e3a9fd4ef8b495ad3d76190c0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  presion_max
Skew: 1.02
Kurtosis:  5.82
</pre></div>
</div>
<img alt="_images/52095d85a994aab89b535c4fef6f902f70009c25d8b7c70115382d41c9735fa9.png" src="_images/52095d85a994aab89b535c4fef6f902f70009c25d8b7c70115382d41c9735fa9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Column:  presion_min
Skew: 0.33
Kurtosis:  4.91
</pre></div>
</div>
<img alt="_images/6557da0255654d08ec101e28099639daf8148d1c761f57640ccd9f929623eca9.png" src="_images/6557da0255654d08ec101e28099639daf8148d1c761f57640ccd9f929623eca9.png" />
</div>
</div>
<p>Vemos posibles datos atípicos en las variables presion_min, presion_max, prec_total, atm.</p>
<p>La variable TEM_MIN muestra en el gráfico que posiblemente sigue una distribución normal. con un leve sesgo positivo (Mayor peso en la cola izquierda de la distribución), lo mismo ocurre con TEM_MAX.</p>
<p>La variable velocidad del viento se ve sesgada, con mayor pero en la cola izquierda, mientras que AUT_MAX Y aut_MIN muestran mayor peso en la cola derecha.</p>
<p>La variable prec_total no evidencia que siga una distribución normal, los datos se concentran en la parte izquierda de la gráfica.</p>
<p>la variable Viento_rajmax también evidencia un sesgo positivo (skew&gt;0)</p>
<p>se visualiza asimetría en varias variables, la variable TEM_MIN aunque está sesgada muestra un poco de simetría en comparación con las demás variables.</p>
</section>
<section id="id1">
<h3>Análisis Bivariado:<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scatter_regplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">strx</span><span class="p">,</span> <span class="n">stry</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">strx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">stry</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">strx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">stry</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Relación entre </span><span class="si">%s</span><span class="s1"> y velocidad&#39;</span><span class="o">%</span><span class="k">col</span>)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nume_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;velocidad&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">nume_cols</span><span class="p">:</span>
    <span class="n">scatter_regplot</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39;velocidad&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/409667ce86b408810e05c8db2c4c29830172c398a86c0315c4b1ff6c5284b68c.png" src="_images/409667ce86b408810e05c8db2c4c29830172c398a86c0315c4b1ff6c5284b68c.png" />
<img alt="_images/6d1c77e6395f06e37348324136bb1e6789f7e0a86a11fbeee9819244c87b5554.png" src="_images/6d1c77e6395f06e37348324136bb1e6789f7e0a86a11fbeee9819244c87b5554.png" />
<img alt="_images/f8984969b607c8a473a9fc2997f4f721e2cfd895fd07885650f46be1d2f26e66.png" src="_images/f8984969b607c8a473a9fc2997f4f721e2cfd895fd07885650f46be1d2f26e66.png" />
<img alt="_images/6634419ae61f7175e46acf82faa0bb6212110143fe3c29f3fb45238f47e1e9bd.png" src="_images/6634419ae61f7175e46acf82faa0bb6212110143fe3c29f3fb45238f47e1e9bd.png" />
<img alt="_images/0c9712e966264b0f201b24f0a5bdf1ae93de80dd417810100b56669957343a6b.png" src="_images/0c9712e966264b0f201b24f0a5bdf1ae93de80dd417810100b56669957343a6b.png" />
<img alt="_images/5a076218e7c311c045966367bf341c3e303405ecdb1dab7b329c193ab9c5a17c.png" src="_images/5a076218e7c311c045966367bf341c3e303405ecdb1dab7b329c193ab9c5a17c.png" />
<img alt="_images/977b56969019ff4c80390adbcd2c07bf8fcbd109ff892a5418a4937e46e3e1c9.png" src="_images/977b56969019ff4c80390adbcd2c07bf8fcbd109ff892a5418a4937e46e3e1c9.png" />
<img alt="_images/b32e724853ce1aaec16007a97c7c41c593139a3706df8ea05e924b78c98a104f.png" src="_images/b32e724853ce1aaec16007a97c7c41c593139a3706df8ea05e924b78c98a104f.png" />
<img alt="_images/89a820c1481dbc363a3a28837421122a728aa6862c793ed19a5987ee7341525a.png" src="_images/89a820c1481dbc363a3a28837421122a728aa6862c793ed19a5987ee7341525a.png" />
<img alt="_images/b96cb59c0ce2732db14edf5eebd22ff79173b96c61943f0f5fbeaaee3acc1cdf.png" src="_images/b96cb59c0ce2732db14edf5eebd22ff79173b96c61943f0f5fbeaaee3acc1cdf.png" />
<img alt="_images/5de60688ca001477a10fba89cd99456393eefddba67a18063131e4c6385f242b.png" src="_images/5de60688ca001477a10fba89cd99456393eefddba67a18063131e4c6385f242b.png" />
</div>
</div>
<p>Se realizó un trazado de scatterplot() , y regplot() con las variables explicativas numéricas.</p>
<p>Velocidad del viento y presion_min muestran una relación lineal entre ellas, a medida que aumenta la presión tiende a aumentar la velocidad del viento.
la misma tendencia se ve entre velocidad del viento y presion_max</p>
<p>se ve una relación lineal directa entre la variable velocidad y vientoraj_max , esto tiene sentido ya que a medida que aumenta este registro del viento, aumentarán la velocidad con la que se desplaza. Esta podría ser una variable apropiada a considerar al momento de realizar la predicción de la velocidad del viento</p>
<ul class="simple">
<li><p>Entre variables predictoras:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">scatter_regplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">strx</span><span class="p">,</span> <span class="n">stry</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">strx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">stry</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">strx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">stry</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Relación entre </span><span class="si">%s</span><span class="s1"> y atm &#39;</span><span class="o">%</span><span class="k">col</span>)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nume_cols</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;atm&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">nume_cols</span><span class="p">:</span>
    <span class="n">scatter_regplot</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b337d3700d0b3c22f8893f60e33126251a2a396cfd2eab5bd6679fd5df8e8a91.png" src="_images/b337d3700d0b3c22f8893f60e33126251a2a396cfd2eab5bd6679fd5df8e8a91.png" />
<img alt="_images/8408b8d1f77bf91c99e64437f2299e6b2b10aa01b1b720567301dc50dafd15a3.png" src="_images/8408b8d1f77bf91c99e64437f2299e6b2b10aa01b1b720567301dc50dafd15a3.png" />
<img alt="_images/55d9b35b44e2e00ec5e23a0d4c9fb6e864a6f1fa453210ea0d2c1ff4b099771e.png" src="_images/55d9b35b44e2e00ec5e23a0d4c9fb6e864a6f1fa453210ea0d2c1ff4b099771e.png" />
<img alt="_images/75121d8dc49ae00815a839c940009ad3f110c3bf8d2fdfa965a2d60442379439.png" src="_images/75121d8dc49ae00815a839c940009ad3f110c3bf8d2fdfa965a2d60442379439.png" />
<img alt="_images/eace78dbe75c0d7eeadbf46109fb09ea2dec49235f9b5e518cccaa4b3d4b90a0.png" src="_images/eace78dbe75c0d7eeadbf46109fb09ea2dec49235f9b5e518cccaa4b3d4b90a0.png" />
<img alt="_images/722630905d3d970ed6da58f9269bf382f6bbb0914cb8213b071663d55e4b5422.png" src="_images/722630905d3d970ed6da58f9269bf382f6bbb0914cb8213b071663d55e4b5422.png" />
<img alt="_images/037d05910489377bccb6bd890cfccd56359e108f0ad8dea3303fe24f8e10748c.png" src="_images/037d05910489377bccb6bd890cfccd56359e108f0ad8dea3303fe24f8e10748c.png" />
<img alt="_images/8adfc9753f398056f2bd551634e76fd5bfe75fab5c98c67852e4f453f4d21cdd.png" src="_images/8adfc9753f398056f2bd551634e76fd5bfe75fab5c98c67852e4f453f4d21cdd.png" />
<img alt="_images/136432c885027b2b383dda1a905102cfa02c0beffadb63c3414e46bdb6670eab.png" src="_images/136432c885027b2b383dda1a905102cfa02c0beffadb63c3414e46bdb6670eab.png" />
<img alt="_images/535420816e4c039f30c53c3205e1ef7cf3483b4713da9e6f196894f59b490bdf.png" src="_images/535420816e4c039f30c53c3205e1ef7cf3483b4713da9e6f196894f59b490bdf.png" />
</div>
</div>
<p>Puede verse que a medida que se tienen mayores registros en de presion_max es porque hay una mayor presión atmosférica.</p>
<p>Vemos que el registro de presion_min será mayor a medida que se encuentre en un espacio de mayor presión atmoférica, esto tiene sentido ya que si la presión atmosférica es alta las mediciones de presion_min irán aumentando.</p>
<p>Vemos que a mayores precipitaciones la presión atmosférica disminuye, sin embargo , es sabido que  si bien las precipitaciones pueden estar asociadas a sistemas de baja presión atmosférica, no causan directamente una disminución significativa de la presión atmosférica en una región en particular.</p>
<p>Se visualiza muy bien la tendencia lineal directa entre la variable presión atmoférica y los registros de presión máxima, esto tiene sentido pues a medida que aumente la presión atmosférica , los registros de presión_max aumentan</p>
<ul class="simple">
<li><p>Matriz de correlación</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;hora&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4d87548c3aa36b4b0982b20f362a008ca02748a44e316f8e9c5f37111d1e3217.png" src="_images/4d87548c3aa36b4b0982b20f362a008ca02748a44e316f8e9c5f37111d1e3217.png" />
</div>
</div>
<p>De la matriz de correlación anterior puede verse que hay algunas variables que se encuentran correlacionadas.</p>
<p>la variable REL_DO evidencia una moderada correlación con las variables TEMP_MAX y TEM_MIN.  De la misma manera hay una moderada correlación entre las variables TEMP_MAX y TEMP_MIN con  AUT_MAX, AUT_MIN. El resto de variables no evidencian una fuerte correlación entre ellas.</p>
</section>
</section>
<section id="reduccion-de-dimensionalidad-vif">
<h2>Reducción de dimensionalidad: VIF<a class="headerlink" href="#reduccion-de-dimensionalidad-vif" title="Permalink to this heading">#</a></h2>
<p>Realizaremos la reducción de dimensionalidad por medio de la eliminación de columnas altamente correlacionadas, usando ‘Variance Inflation Factor (VIF)’, un VIF mayo o igual a 5 indica alta multicolinealidad entre las correspondiente variable dependiente y las demás variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Las variables predictoras</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;velocidad&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hora</th>
      <th>viento_direc</th>
      <th>AUT_max</th>
      <th>AUT_min</th>
      <th>TEMP_MAX</th>
      <th>TEMP_MIN</th>
      <th>REL_DO</th>
      <th>atm</th>
      <th>prec_total</th>
      <th>Viento_rajmax</th>
      <th>presion_max</th>
      <th>presion_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12:00</td>
      <td>0.809017</td>
      <td>69.0</td>
      <td>60.0</td>
      <td>22.6</td>
      <td>20.7</td>
      <td>61.0</td>
      <td>888.2</td>
      <td>0.0</td>
      <td>3.8</td>
      <td>888.2</td>
      <td>887.7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13:00</td>
      <td>0.965926</td>
      <td>62.0</td>
      <td>55.0</td>
      <td>24.2</td>
      <td>22.5</td>
      <td>55.0</td>
      <td>888.4</td>
      <td>0.0</td>
      <td>4.7</td>
      <td>888.4</td>
      <td>888.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14:00</td>
      <td>0.891007</td>
      <td>56.0</td>
      <td>50.0</td>
      <td>25.5</td>
      <td>24.3</td>
      <td>51.0</td>
      <td>888.1</td>
      <td>0.0</td>
      <td>4.9</td>
      <td>888.4</td>
      <td>888.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15:00</td>
      <td>0.848048</td>
      <td>52.0</td>
      <td>44.0</td>
      <td>27.4</td>
      <td>25.0</td>
      <td>44.0</td>
      <td>887.4</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>888.1</td>
      <td>887.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16:00</td>
      <td>0.224951</td>
      <td>50.0</td>
      <td>43.0</td>
      <td>27.1</td>
      <td>25.5</td>
      <td>46.0</td>
      <td>886.5</td>
      <td>0.0</td>
      <td>5.8</td>
      <td>887.4</td>
      <td>886.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 87693 entries, 0 to 87692
Data columns (total 12 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   hora           87693 non-null  object 
 1   viento_direc   87693 non-null  float64
 2   AUT_max        87693 non-null  float64
 3   AUT_min        87693 non-null  float64
 4   TEMP_MAX       87693 non-null  float64
 5   TEMP_MIN       87693 non-null  float64
 6   REL_DO         87693 non-null  float64
 7   atm            87693 non-null  float64
 8   prec_total     87693 non-null  float64
 9   Viento_rajmax  87693 non-null  float64
 10  presion_max    87693 non-null  float64
 11  presion_min    87693 non-null  float64
dtypes: float64(11), object(1)
memory usage: 8.0+ MB
</pre></div>
</div>
</div>
</div>
<p>Se decidió excluir la variable hora, ya que al incluirla , la técnica VIF excluía la variable “Ráfaga de viento máxima”, la cual se considera importante para predecir la velocidad del viento, esta última variable fue la que mostró mejor asociación lineal con la variable respuesta, por tanto, se ha decido dar prioridad a esta variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calcula el VIF para cada variable predictora</span>
<span class="k">def</span> <span class="nf">reduccion_VIF</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">vif_dt</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">vif_dt</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">vif_dt</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">vif_dt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reduccion_VIF</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;hora&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>VIF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>viento_direc</td>
      <td>1.714903</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AUT_max</td>
      <td>1035.490461</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AUT_min</td>
      <td>868.669868</td>
    </tr>
    <tr>
      <th>3</th>
      <td>TEMP_MAX</td>
      <td>2431.219027</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TEMP_MIN</td>
      <td>2035.022178</td>
    </tr>
    <tr>
      <th>5</th>
      <td>REL_DO</td>
      <td>593.271593</td>
    </tr>
    <tr>
      <th>6</th>
      <td>atm</td>
      <td>239633.065205</td>
    </tr>
    <tr>
      <th>7</th>
      <td>prec_total</td>
      <td>1.137503</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Viento_rajmax</td>
      <td>7.476801</td>
    </tr>
    <tr>
      <th>9</th>
      <td>presion_max</td>
      <td>944178.864436</td>
    </tr>
    <tr>
      <th>10</th>
      <td>presion_min</td>
      <td>965371.723991</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">seleccion_predictoras</span><span class="p">(</span><span class="n">xdf</span><span class="p">,</span><span class="n">VIFMAX</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">xdf</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">VIF</span><span class="o">=</span><span class="n">reduccion_VIF</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">VIF</span><span class="p">[</span><span class="s1">&#39;VIF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">&gt;</span><span class="n">VIFMAX</span><span class="p">:</span>
        <span class="n">indice_maximo</span> <span class="o">=</span> <span class="n">VIF</span><span class="p">[</span><span class="s1">&#39;VIF&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
        <span class="n">columna_max</span> <span class="o">=</span><span class="n">VIF</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">indice_maximo</span><span class="p">,</span> <span class="s1">&#39;variable&#39;</span><span class="p">]</span>
        <span class="n">X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">columna_max</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">VIF</span><span class="o">=</span><span class="n">reduccion_VIF</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>   
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variables predictoras seleccionadas: &quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">seleccion_predictoras</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;hora&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="n">VIFMAX</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variables predictoras seleccionadas: 
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>viento_direc</th>
      <th>AUT_min</th>
      <th>prec_total</th>
      <th>Viento_rajmax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.809017</td>
      <td>60.0</td>
      <td>0.0</td>
      <td>3.8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.965926</td>
      <td>55.0</td>
      <td>0.0</td>
      <td>4.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.891007</td>
      <td>50.0</td>
      <td>0.0</td>
      <td>4.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.848048</td>
      <td>44.0</td>
      <td>0.0</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.224951</td>
      <td>43.0</td>
      <td>0.0</td>
      <td>5.8</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87688</th>
      <td>-0.615661</td>
      <td>78.0</td>
      <td>0.0</td>
      <td>12.3</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>-0.469472</td>
      <td>79.0</td>
      <td>0.0</td>
      <td>9.9</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>-0.484810</td>
      <td>82.0</td>
      <td>0.0</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>-0.484810</td>
      <td>85.0</td>
      <td>0.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>-0.573576</td>
      <td>88.0</td>
      <td>0.6</td>
      <td>7.5</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 4 columns</p>
</div></div></div>
</div>
<p>Las variables predictoras resultantes son:</p>
<ul class="simple">
<li><p>Dirección del viento–&gt; ‘viento_direc’</p></li>
<li><p>Humedad rel. mín. hora anterior—-&gt; AUT_min</p></li>
<li><p>Precipitación total por hora —-&gt; prec_total</p></li>
<li><p>ráfaga de viento máxima—–&gt; Viento_rajmax</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="velocidad-del-viento-modelos">
<h1>VELOCIDAD DEL VIENTO: MODELOS<a class="headerlink" href="#velocidad-del-viento-modelos" title="Permalink to this heading">#</a></h1>
<section id="entrenamiento-y-validacion">
<h2>Entrenamiento y validación<a class="headerlink" href="#entrenamiento-y-validacion" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_datos</span><span class="o">=</span><span class="n">df2</span><span class="p">[[</span><span class="s1">&#39;velocidad&#39;</span><span class="p">,</span><span class="s1">&#39;Viento_rajmax&#39;</span><span class="p">,</span> <span class="s1">&#39;prec_total&#39;</span><span class="p">,</span> <span class="s1">&#39;viento_direc&#39;</span><span class="p">,</span> <span class="s1">&#39;AUT_min&#39;</span><span class="p">]]</span>
<span class="n">base_datos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>velocidad</th>
      <th>Viento_rajmax</th>
      <th>prec_total</th>
      <th>viento_direc</th>
      <th>AUT_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.8</td>
      <td>3.8</td>
      <td>0.0</td>
      <td>0.809017</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.7</td>
      <td>4.7</td>
      <td>0.0</td>
      <td>0.965926</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.0</td>
      <td>4.9</td>
      <td>0.0</td>
      <td>0.891007</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.5</td>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.848048</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.4</td>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.224951</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87688</th>
      <td>5.6</td>
      <td>12.3</td>
      <td>0.0</td>
      <td>-0.615661</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>4.9</td>
      <td>9.9</td>
      <td>0.0</td>
      <td>-0.469472</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>4.5</td>
      <td>8.9</td>
      <td>0.0</td>
      <td>-0.484810</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>3.2</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>-0.484810</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>2.3</td>
      <td>7.5</td>
      <td>0.6</td>
      <td>-0.573576</td>
      <td>88.0</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">base_datos</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">base_datos</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">base_datos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>velocidad</th>
      <th>Viento_rajmax</th>
      <th>prec_total</th>
      <th>viento_direc</th>
      <th>AUT_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.8</td>
      <td>3.8</td>
      <td>0.0</td>
      <td>0.809017</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.7</td>
      <td>4.7</td>
      <td>0.0</td>
      <td>0.965926</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
      <td>4.9</td>
      <td>0.0</td>
      <td>0.891007</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.5</td>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.848048</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.4</td>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.224951</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>87689</th>
      <td>5.6</td>
      <td>12.3</td>
      <td>0.0</td>
      <td>-0.615661</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>87690</th>
      <td>4.9</td>
      <td>9.9</td>
      <td>0.0</td>
      <td>-0.469472</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>87691</th>
      <td>4.5</td>
      <td>8.9</td>
      <td>0.0</td>
      <td>-0.484810</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>87692</th>
      <td>3.2</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>-0.484810</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>87693</th>
      <td>2.3</td>
      <td>7.5</td>
      <td>0.6</td>
      <td>-0.573576</td>
      <td>88.0</td>
    </tr>
  </tbody>
</table>
<p>87693 rows × 5 columns</p>
</div></div></div>
</div>
<p>Tenemos 87693 observaciones, formaremos los respectivos conjuntos de entrenamiento, validación y testeo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># variables predictoras:</span>
<span class="n">XX</span><span class="o">=</span><span class="n">base_datos</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;velocidad&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">XX</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Viento_rajmax</th>
      <th>prec_total</th>
      <th>viento_direc</th>
      <th>AUT_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3.8</td>
      <td>0.0</td>
      <td>0.809017</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>0.0</td>
      <td>0.965926</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.9</td>
      <td>0.0</td>
      <td>0.891007</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.848048</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.224951</td>
      <td>43.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">=</span><span class="n">base_datos</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;prec_total&#39;</span><span class="p">,</span> <span class="s1">&#39;viento_direc&#39;</span><span class="p">,</span> <span class="s1">&#39;AUT_min&#39;</span><span class="p">,</span> <span class="s1">&#39;Viento_rajmax&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>velocidad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Realizamos la partición de los datos para X_train , X_test, Y_train, Y_test</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tamaño</span><span class="o">=</span><span class="mi">24</span>
<span class="n">x_train</span><span class="o">=</span><span class="p">[]</span>
<span class="n">x_test</span><span class="o">=</span><span class="p">[]</span>
<span class="n">y_train</span><span class="o">=</span><span class="p">[]</span>
<span class="n">y_test</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="n">tamaño</span><span class="p">):</span>
    <span class="n">xtrain</span> <span class="o">=</span> <span class="n">XX</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="n">tamaño</span><span class="p">]</span>
    <span class="n">ytrain</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="n">tamaño</span><span class="p">]</span>
    
    <span class="c1"># Añadir a x_train y y_train</span>
    <span class="n">x_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xtrain</span><span class="p">)</span>
    <span class="n">y_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ytrain</span><span class="p">)</span>
    
    <span class="n">xtest</span> <span class="o">=</span> <span class="n">XX</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">tamaño</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tamaño</span><span class="p">]</span>
    <span class="n">ytest</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">tamaño</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">tamaño</span><span class="p">]</span>
    <span class="n">x_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xtest</span><span class="p">)</span>
    <span class="n">y_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ytest</span><span class="p">)</span>
   
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1200
</pre></div>
</div>
</div>
</div>
<section id="k-nn-regresion">
<h3>K-NN (Regresión):<a class="headerlink" href="#k-nn-regresion" title="Permalink to this heading">#</a></h3>
<p>Para medir la eficacia de este modelo se usará la métrica <span class="math notranslate nohighlight">\(R^2\)</span>, RMSE y MAPE</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">20</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grid_searchKNN</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">best_k</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_rmse</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">]:</span>
        <span class="n">rmse</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">)):</span>
            <span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="n">y_pred</span><span class="p">))</span>
            <span class="n">rmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">avg_rmse</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">avg_rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
            <span class="n">best_rmse</span><span class="o">=</span><span class="n">avg_rmse</span>
            <span class="n">best_k</span><span class="o">=</span><span class="n">k</span>
    <span class="k">return</span> <span class="n">best_k</span><span class="p">,</span> <span class="n">best_rmse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_searchKNN</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(6, 0.6372764815456139)
</pre></div>
</div>
</div>
</div>
</section>
<section id="regresion-ridge">
<h3>Regresión Ridge:<a class="headerlink" href="#regresion-ridge" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params_alpha</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grid_search_Ridge</span><span class="p">(</span><span class="n">params_alpha</span><span class="p">):</span>
    <span class="n">best_alpha</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_rmse</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params_alpha</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]:</span>
        <span class="n">rmse</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">ridge</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">)):</span>
            <span class="n">ridge</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">ridge</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="n">y_pred</span><span class="p">))</span>
            <span class="n">rmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">avg_rmse</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">avg_rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
            <span class="n">best_rmse</span><span class="o">=</span><span class="n">avg_rmse</span>
            <span class="n">best_alpha</span><span class="o">=</span><span class="n">p</span>
    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_rmse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_search_Ridge</span><span class="p">(</span><span class="n">params_alpha</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5, 0.5258638490552863)
</pre></div>
</div>
</div>
</div>
</section>
<section id="regresion-lasso">
<h3>Regresión Lasso:<a class="headerlink" href="#regresion-lasso" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params_alfa</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha&#39;</span><span class="p">:[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">grid_search_Lasso</span><span class="p">(</span><span class="n">params_alfa</span><span class="p">):</span>
    <span class="n">best_alpha</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_rmse</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">params_alfa</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">]:</span>
        <span class="n">rmse</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">lasso</span><span class="o">=</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">)):</span>
            <span class="n">lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="n">y_pred</span><span class="p">))</span>
            <span class="n">rmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">avg_rmse</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">avg_rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
            <span class="n">best_rmse</span><span class="o">=</span><span class="n">avg_rmse</span>
            <span class="n">best_alpha</span><span class="o">=</span><span class="n">p</span>
    <span class="k">return</span> <span class="n">best_alpha</span><span class="p">,</span> <span class="n">best_rmse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_search_Lasso</span><span class="p">(</span><span class="n">params_alfa</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.001, 0.5262308262673426)
</pre></div>
</div>
</div>
</div>
</section>
<section id="mlp-regresion">
<h3>MLP ( Regresión)<a class="headerlink" href="#mlp-regresion" title="Permalink to this heading">#</a></h3>
<p>Debido al costo computacional que lleva entrenar este modelo con todas las combinaciones propuestas, se usarán menos particiones del conjunto de entrenamiento y prueba.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">ParameterGrid</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;hiddenn_layer&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">100</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">]],</span>  
    <span class="s1">&#39;solver&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;adam&#39;</span><span class="p">],</span>
    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
<span class="n">param_grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;alpha&#39;: 0.0001, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 0.0001, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 0.01, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 0.01, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 0.1, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 0.1, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 1, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 1, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 10, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;},
 {&#39;alpha&#39;: 10, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_list</span><span class="o">=</span><span class="p">[]</span>
<span class="n">mae</span><span class="o">=</span><span class="p">[]</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">grid_search_MLP</span><span class="p">(</span><span class="n">param_grid</span><span class="p">):</span>
    <span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_rmse</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_grid</span><span class="p">:</span>
        <span class="n">param_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="n">mlp_regressor</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;hiddenn_layer&#39;</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;solver&#39;</span><span class="p">],</span> 
                             <span class="n">alpha</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;alpha&#39;</span><span class="p">],</span> <span class="n">batch_size</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
        <span class="n">rmse</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">)):</span>
            <span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">mlp_regressor</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_pred</span><span class="o">=</span><span class="n">mlp_regressor</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="n">y_pred</span><span class="p">))</span>
            <span class="n">rmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">avg_rmse</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse</span><span class="p">))</span>
        <span class="n">mae</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">avg_rmse</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">avg_rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
            <span class="n">best_rmse</span><span class="o">=</span><span class="n">avg_rmse</span>
            <span class="n">best_params</span><span class="o">=</span><span class="n">params</span>
    <span class="k">return</span> <span class="n">best_params</span><span class="p">,</span> <span class="n">best_rmse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid_search_MLP</span><span class="p">(</span><span class="n">param_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>({&#39;alpha&#39;: 1, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;},
 0.5284708848903205)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Combinar las listas losses y params_list utilizando zip()</span>
<span class="n">losses_with_params</span> <span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mae</span><span class="p">,</span> <span class="n">param_list</span><span class="p">))</span>
<span class="c1"># Imprimir los valores de pérdida junto con sus respectivos hiperparámetros</span>
<span class="k">for</span> <span class="n">loss</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">losses_with_params</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Loss:&#39;</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hyperparameters:&#39;</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loss: 0.5729352277632793
Hyperparameters: {&#39;alpha&#39;: 0.0001, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.5789118557807476
Hyperparameters: {&#39;alpha&#39;: 0.0001, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.5737890676055095
Hyperparameters: {&#39;alpha&#39;: 0.01, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.578615795494546
Hyperparameters: {&#39;alpha&#39;: 0.01, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.5655352331086658
Hyperparameters: {&#39;alpha&#39;: 0.1, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.5715361531533094
Hyperparameters: {&#39;alpha&#39;: 0.1, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.5297111061975409
Hyperparameters: {&#39;alpha&#39;: 1, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.5284708848903205
Hyperparameters: {&#39;alpha&#39;: 1, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.5595681934864761
Hyperparameters: {&#39;alpha&#39;: 10, &#39;hiddenn_layer&#39;: [100, 50], &#39;solver&#39;: &#39;adam&#39;}

Loss: 0.5585296989701063
Hyperparameters: {&#39;alpha&#39;: 10, &#39;hiddenn_layer&#39;: [100, 100], &#39;solver&#39;: &#39;adam&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="svm">
<h3>SVM:<a class="headerlink" href="#svm" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametros</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>  
    <span class="s1">&#39;C&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid_SVM</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">parametros</span><span class="p">))</span>
<span class="n">param_grid_SVM</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.001},
 {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.01},
 {&#39;C&#39;: 0.001, &#39;gamma&#39;: 0.1},
 {&#39;C&#39;: 0.001, &#39;gamma&#39;: 1},
 {&#39;C&#39;: 0.001, &#39;gamma&#39;: 10},
 {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.001},
 {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.01},
 {&#39;C&#39;: 0.01, &#39;gamma&#39;: 0.1},
 {&#39;C&#39;: 0.01, &#39;gamma&#39;: 1},
 {&#39;C&#39;: 0.01, &#39;gamma&#39;: 10},
 {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.001},
 {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.01},
 {&#39;C&#39;: 0.1, &#39;gamma&#39;: 0.1},
 {&#39;C&#39;: 0.1, &#39;gamma&#39;: 1},
 {&#39;C&#39;: 0.1, &#39;gamma&#39;: 10},
 {&#39;C&#39;: 1, &#39;gamma&#39;: 0.001},
 {&#39;C&#39;: 1, &#39;gamma&#39;: 0.01},
 {&#39;C&#39;: 1, &#39;gamma&#39;: 0.1},
 {&#39;C&#39;: 1, &#39;gamma&#39;: 1},
 {&#39;C&#39;: 1, &#39;gamma&#39;: 10},
 {&#39;C&#39;: 10, &#39;gamma&#39;: 0.001},
 {&#39;C&#39;: 10, &#39;gamma&#39;: 0.01},
 {&#39;C&#39;: 10, &#39;gamma&#39;: 0.1},
 {&#39;C&#39;: 10, &#39;gamma&#39;: 1},
 {&#39;C&#39;: 10, &#39;gamma&#39;: 10}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">gridsearch_SVM</span><span class="p">(</span><span class="n">param_grid_SVM</span><span class="p">):</span>
    <span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_rmse</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">param_grid_SVM</span><span class="p">:</span>
        <span class="n">svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">],</span> <span class="n">C</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">])</span>
        <span class="n">rmse</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">)):</span>
            <span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_pred</span><span class="o">=</span><span class="n">svr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="n">y_pred</span><span class="p">))</span>
            <span class="n">rmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">avg_rmse</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">avg_rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
            <span class="n">best_rmse</span><span class="o">=</span><span class="n">avg_rmse</span>
            <span class="n">best_params</span><span class="o">=</span><span class="n">params</span>
    <span class="k">return</span> <span class="n">best_params</span><span class="p">,</span> <span class="n">best_rmse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gridsearch_SVM</span><span class="p">(</span><span class="n">param_grid_SVM</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>({&#39;C&#39;: 10, &#39;gamma&#39;: 0.01}, 0.5220041712622059)
</pre></div>
</div>
</div>
</div>
</section>
<section id="xgboosting">
<h3>XGBoosting:<a class="headerlink" href="#xgboosting" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametros_XG</span> <span class="o">=</span>  <span class="p">{</span>
    <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span>
    <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parametros_XGb</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ParameterGrid</span><span class="p">(</span><span class="n">parametros_XG</span><span class="p">))</span>
<span class="n">parametros_XGb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[{&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 300},
 {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 300},
 {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 300},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 300},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 300},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.01, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 300},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 300},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 4, &#39;n_estimators&#39;: 300},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 100},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 200},
 {&#39;learning_rate&#39;: 0.001, &#39;max_depth&#39;: 5, &#39;n_estimators&#39;: 300}]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">xgboost</span><span class="p">(</span><span class="n">parametros_XGb</span><span class="p">):</span>
    <span class="n">best_params</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">best_rmse</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">parametros_XGb</span><span class="p">:</span>
        <span class="n">XGBs</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="s2">&quot;reg:squarederror&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">rmse</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">)):</span>
            <span class="n">XGBs</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">y_train</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">y_pred</span><span class="o">=</span><span class="n">XGBs</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span><span class="n">y_pred</span><span class="p">))</span>
            <span class="n">rmse</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">avg_rmse</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rmse</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">avg_rmse</span> <span class="o">&lt;</span> <span class="n">best_rmse</span><span class="p">:</span>
            <span class="n">best_rmse</span><span class="o">=</span><span class="n">avg_rmse</span>
            <span class="n">best_params</span><span class="o">=</span><span class="n">params</span>
    <span class="k">return</span> <span class="n">best_params</span><span class="p">,</span> <span class="n">best_rmse</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xgboost</span><span class="p">(</span><span class="n">parametros_XGb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>({&#39;learning_rate&#39;: 0.1, &#39;max_depth&#39;: 3, &#39;n_estimators&#39;: 100},
 0.5520529587045568)
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparacion-entre-mejores-modelos">
<h3>Comparación entre mejores modelos:<a class="headerlink" href="#comparacion-entre-mejores-modelos" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># variables predictoras:</span>
<span class="n">XX</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Viento_rajmax</th>
      <th>prec_total</th>
      <th>viento_direc</th>
      <th>AUT_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3.8</td>
      <td>0.0</td>
      <td>0.809017</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>0.0</td>
      <td>0.965926</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.9</td>
      <td>0.0</td>
      <td>0.891007</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.848048</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.224951</td>
      <td>43.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Variable dependiente:</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Partimos nuevamente la base de datos y formamos un set de entrenamiento y uno de testeo. El set de entrenamiento se usará con cada uno de los mejores modelos obtenidos, una vez entrenados se hará la rpedicción de las últimas 24 observaciones y se calculará el <span class="math notranslate nohighlight">\(R^2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XTRAIN</span> <span class="o">=</span> <span class="n">XX</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">87669</span><span class="p">]</span>
<span class="n">XTRAIN</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Viento_rajmax</th>
      <th>prec_total</th>
      <th>viento_direc</th>
      <th>AUT_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>3.8</td>
      <td>0.0</td>
      <td>0.809017</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>0.0</td>
      <td>0.965926</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.9</td>
      <td>0.0</td>
      <td>0.891007</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.848048</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5.8</td>
      <td>0.0</td>
      <td>0.224951</td>
      <td>43.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YTRAIN</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">87669</span><span class="p">]</span>
<span class="n">YTRAIN</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>velocidad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2.4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XTEST</span><span class="o">=</span><span class="n">XX</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">24</span><span class="p">:]</span>
<span class="n">XTEST</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Viento_rajmax</th>
      <th>prec_total</th>
      <th>viento_direc</th>
      <th>AUT_min</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>87670</th>
      <td>3.5</td>
      <td>0.0</td>
      <td>-0.224951</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>87671</th>
      <td>3.4</td>
      <td>0.0</td>
      <td>-0.515038</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>87672</th>
      <td>3.9</td>
      <td>0.0</td>
      <td>-0.406737</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>87673</th>
      <td>4.5</td>
      <td>0.0</td>
      <td>-0.275637</td>
      <td>93.0</td>
    </tr>
    <tr>
      <th>87674</th>
      <td>4.5</td>
      <td>0.0</td>
      <td>-0.052336</td>
      <td>94.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">XTEST</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YTEST</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">24</span><span class="p">:]</span>
<span class="n">YTEST</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>velocidad</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>87670</th>
      <td>1.8</td>
    </tr>
    <tr>
      <th>87671</th>
      <td>2.1</td>
    </tr>
    <tr>
      <th>87672</th>
      <td>1.9</td>
    </tr>
    <tr>
      <th>87673</th>
      <td>2.6</td>
    </tr>
    <tr>
      <th>87674</th>
      <td>2.6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="calculo-del-r-2">
<h4>Cálculo del <span class="math notranslate nohighlight">\(R^2\)</span>:<a class="headerlink" href="#calculo-del-r-2" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>KNN (Regresión):</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">knn1</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="n">knn1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTRAIN</span><span class="p">,</span> <span class="n">YTRAIN</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTEST</span><span class="p">)</span>
<span class="n">r2_knn1</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">YTEST</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_knn1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8693973960133655
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Regresión Ridge:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ridge1</span><span class="o">=</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">ridge1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTRAIN</span><span class="p">,</span> <span class="n">YTRAIN</span><span class="p">)</span>
<span class="n">y_pred_ridge</span> <span class="o">=</span> <span class="n">ridge1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTEST</span><span class="p">)</span>
<span class="n">r2_ridge</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">YTEST</span><span class="p">,</span> <span class="n">y_pred_ridge</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_ridge</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8550641628875353
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Regresión Lasso:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lasso1</span><span class="o">=</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">lasso1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTRAIN</span><span class="p">,</span> <span class="n">YTRAIN</span><span class="p">)</span>
<span class="n">y_pred_lasso</span> <span class="o">=</span> <span class="n">lasso1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTEST</span><span class="p">)</span>
<span class="n">r2_lasso</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">YTEST</span><span class="p">,</span> <span class="n">y_pred_lasso</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_lasso</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8551393359092903
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>MLP:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mlp_regressor1</span> <span class="o">=</span> <span class="n">MLPRegressor</span><span class="p">(</span><span class="n">hidden_layer_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span> 
                             <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XT</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">XTRAIN</span><span class="p">)</span>
<span class="n">X_test1</span><span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">XTEST</span><span class="p">)</span>
<span class="n">ytest1</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">YTEST</span><span class="p">)</span>
<span class="n">YT</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">YTRAIN</span><span class="p">)</span>
<span class="n">mlp_regressor1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XT</span><span class="p">,</span> <span class="n">YT</span><span class="p">)</span>
<span class="n">y_pred_mlp</span><span class="o">=</span><span class="n">mlp_regressor1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test1</span><span class="p">)</span>
<span class="n">r2_MLP</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">ytest1</span><span class="p">,</span> <span class="n">y_pred_mlp</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_MLP</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8668644875014058
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svr1</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">svr1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XT</span><span class="p">,</span> <span class="n">YT</span><span class="p">)</span>
<span class="n">y_pred_svr</span><span class="o">=</span><span class="n">svr1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test1</span><span class="p">)</span>
<span class="n">r2_svr</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">ytest1</span><span class="p">,</span> <span class="n">y_pred_svr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_svr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.31217359211731477
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">XGBs1</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="s2">&quot;reg:squarederror&quot;</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,)</span>
<span class="n">XGBs1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">XTRAIN</span><span class="p">,</span> <span class="n">YTRAIN</span><span class="p">)</span>
<span class="n">y_pred_XG</span> <span class="o">=</span> <span class="n">XGBs1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XTEST</span><span class="p">)</span>
<span class="n">r2_XG</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">YTEST</span><span class="p">,</span> <span class="n">y_pred_XG</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">r2_XG</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7786498407921217
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="resultados">
<h2>Resultados:<a class="headerlink" href="#resultados" title="Permalink to this heading">#</a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Modelo</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(R^2\)</span></p></th>
<th class="head"><p>RMSE</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>K-NN</p></td>
<td><p>0.869</p></td>
<td><p>0.6372</p></td>
</tr>
<tr class="row-odd"><td><p>Ridge</p></td>
<td><p>0.855</p></td>
<td><p>0.525</p></td>
</tr>
<tr class="row-even"><td><p>Lasso</p></td>
<td><p>0.855</p></td>
<td><p>0.526</p></td>
</tr>
<tr class="row-odd"><td><p>XGBoost</p></td>
<td><p>0.778</p></td>
<td><p>0.552</p></td>
</tr>
<tr class="row-even"><td><p>SVM</p></td>
<td><p>0.312</p></td>
<td><p>0.522</p></td>
</tr>
<tr class="row-odd"><td><p>MLP</p></td>
<td><p>0.866</p></td>
<td><p>0.528</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conclusiones">
<h1>CONCLUSIONES:<a class="headerlink" href="#conclusiones" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>Se abordó con éxito la tarea de predecir la velocidad del viento utilizando un conjunto reducido de variables explicativas.</p></li>
<li><p>Proceso de Limpieza y Exploración de Datos: Se llevó a cabo un proceso de limpieza y exploración exhaustiva de los datos antes de construir los modelos de predicción. Esto incluyó la identificación y manejo de valores atípicos, así como la detección de multicolinealidad utilizando el VIF.</p></li>
<li><p>Se evaluaron varios algoritmos de aprendizaje automático, incluyendo K-Vecinos Cercanos (KNN), Redes Neuronales Artificiales (MLP), Ridge, Lasso, Support Vector Machines (SVM), XGBoost y SVM de regresión. Se buscó determinar cuál de estos modelos ofrecía el mejor rendimiento en la predicción de la velocidad del viento. Para evaluar el rendimiento de los modelos, se utilizaron métricas comunes como el coeficiente de determinación (R^2) y la raíz del error cuadrático medio (RMSE). Estas métricas proporcionaron una medida cuantitativa de la capacidad de los modelos para realizar predicciones precisas.</p></li>
<li><p>El hecho de que el modelo de Red Neuronal Artificial (Multilayer Perceptron - MLP) haya tenido un valor bajo de RMSE (Root Mean Squared Error) y al mismo tiempo un valor alto de <span class="math notranslate nohighlight">\(R^2\)</span> (coeficiente de determinación) es un resultado muy positivo. Estos resultados sugieren que el modelo MLP fue capaz de realizar predicciones precisas de la velocidad del viento y explicar una gran proporción de la variabilidad en los datos.</p></li>
<li><p>De todos los modelos, SVM tuvo el menor rendimiento, explicando solo un 31,2% de la variabilidad de los datos.</p></li>
<li><p>La métrica MAPE se excluyó ya que en muchas ocasiones no podía ser calculada, esto debido a la presencia de ceros la variable dependiente.</p></li>
<li><p>Hay que tener en cuenta que debido a los costos computacionales y el gran tamaño de la base de datos fue necesario tomar una parte de los datos de entrenamiento y validación, ya que al considerar todas las particiones de la data , los modelos tardaban demasiado en correr, algunos incluso nunca finalizaron. se consideraron 50 particiones de los datos de entrenamiento  y validación , donde las predicciónes eran de 24 observaciones siguientes mientras que x_train aumentaba 24 unidades en cada partición.  Con estos conjuntos de entrenamiento y prueba fue posible obtener resultados alentadores.</p></li>
</ul>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to your Jupyter Book</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PARCIAL FINAL</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deteccion-de-fraudes">DETECCIÓN DE FRAUDES</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-la-base-de-datos">Análisis exploratorio de la base de datos:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-variables-independientes">selección de variables independientes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-faltantes">Datos faltantes:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histogramas-y-diagramas-de-barras">Histogramas y diagramas de barras:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-bivariado">Análisis bivariado:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-dimensionalidad">Reducción de dimensionalidad:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#imputacion-a-datos-faltantes">Imputación a datos faltantes:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vif">VIF:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-de-la-velocidad-del-viento">PREDICCIÓN DE LA VELOCIDAD DEL VIENTO:</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-los-datos">Analisis exploratorio de los datos:</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#histograma-y-diagrama-de-barras">Histograma y Diagrama de barras:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Análisis Bivariado:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduccion-de-dimensionalidad-vif">Reducción de dimensionalidad: VIF</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#velocidad-del-viento-modelos">VELOCIDAD DEL VIENTO: MODELOS</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#entrenamiento-y-validacion">Entrenamiento y validación</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#k-nn-regresion">K-NN (Regresión):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-ridge">Regresión Ridge:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-lasso">Regresión Lasso:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mlp-regresion">MLP ( Regresión)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#svm">SVM:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#xgboosting">XGBoosting:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-entre-mejores-modelos">Comparación entre mejores modelos:</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#calculo-del-r-2">Cálculo del <span class="math notranslate nohighlight">\(R^2\)</span>:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resultados">Resultados:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">CONCLUSIONES:</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Angie Vanesa Guerrero bertel
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>